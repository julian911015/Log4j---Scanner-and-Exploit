# Log4Shell-Scanner-Exploit
Script en bash que permite identificar y explotar la vulnerabilidad Log4shell CVE-2021-44228 de forma remota.
# Siempre utilizar este script con autorización previa del propietario del servicio/aplicación auditada.

# Dependencias:

1. Descargar y descomprimir el siguiente fichero para iniciar el servidor LDAP y HTTP: 
http://tiny.cc/t0smuz

2. Tener Java instalado
#sudo apt install default-jre

3. tener Curl instalado
#sudo apt-get install curl


# Ejemplo de uso:

1. Generar la lista de URL para analizar, en caso de no tenerlo se puede generar utilizando la función de Spider de OWASP ZAP o herramientas similares. 

2. Debes ingresar los siguientes parámetros:
*	Diccionario de URLs a escanear
*	Dirección IP del servidor LDAP
*	Puerto servidor LDAP
*	Dirección IP servidor HTTP
*	Puerto servidor HTTP

#Ejemplo escaneo de aplicación en red interna: 
* ./Log4Shell_Scanner.sh <Diccionario_URL> <IP_Servidor_LDAP> <Puerto_Servidor_LDAP> <IP_Servidor_HTTP> <Puerto_Servidor_HTTP>

![image](https://user-images.githubusercontent.com/26369589/146909267-14d15a5a-f9fe-4000-b807-7f7a946d6d6d.png)

#Ejemplo escaneo de aplicación en internet:
* ./Log4Shell_Scanner.sh <Diccionario_URL> <IP_Servidor_LDAP> <Puerto_Servidor_LDAP> <IP_Servidor_HTTP> <Puerto_Servidor_HTTP>

![image](https://user-images.githubusercontent.com/26369589/146910362-56b89fee-6d5a-44c7-a2d9-d5ad65853ae3.png)


# Aclaraciones:

* El payload utilizado envía un comando "ifconfig" a las máquinas identificadas como vulnerables, este payload esta codificado en Base64 y puede ser modificado para realizar la fase de explotación en una auditoría de pentesting.
* El fichero JNDIExploit debe estar en /root/ServerLDAP-HTTP-Exploit-Log4Shell/ de lo contrario se debe modificar la ruta en el script
* Si se desea utilizar la herramienta en servicios de internet se puede iniciar un servicio de Ngrok que haga un port forwarding al puerto local del Servidor LDAP
* Siempre utilizar este script con autorización previa del propietario del servicio/aplicación analizada.
